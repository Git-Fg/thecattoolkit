# Multi-Layer Action Space

Agents use a small set of atomic tools to perform a wide range of actions by pushing complexity to the computer layer.

## The Problem

Tool definitions consume context:
- Each tool has schema + description
- MCP servers can add tens of thousands of tokens
- Overlapping tools confuse models

## The Solution: Action Hierarchy

```
┌───────────────────────────────────────┐
│ Level 1: Tool Calling                 │
│ (Agent-visible, ~12-20 tools)         │
│ - Bash, Read, Write, Edit, Grep, Glob │
└──────────────────┬────────────────────┘
                   │
                   ▼
┌───────────────────────────────────────┐
│ Level 2: Shell Utilities / CLIs       │
│ (Computer-level, unlimited)           │
│ - git, npm, docker, jq, ripgrep, ...  │
└──────────────────┬────────────────────┘
                   │
                   ▼
┌───────────────────────────────────────┐
│ Level 3: Code Execution               │
│ (Dynamic, generated by agent)         │
│ - Python scripts, shell scripts       │
└───────────────────────────────────────┘
```

## Production Examples

| Agent | Tool Count | How Broader Actions Work |
|:------|:-----------|:-------------------------|
| Claude Code | ~12 | Bash tool executes CLIs and scripts |
| Manus | <20 | Bash tool on virtual computer |
| Amp Code | ~10 | Curated action space + code execution |

## Benefits

### Token Savings
- Fewer tool definitions in context
- Intermediate results stay on computer (not in context)
- Agent processes only final output

### Flexibility
- Shell provides unlimited capabilities
- Agent writes code for novel operations
- No need to predict all possible actions

### Composability
- Chain actions via code
- CodeAct pattern: write script, execute, parse result
- Complex workflows without tool proliferation

## Implementation Guidelines

### Core Tools (Level 1)

Every agent should have:
- **Bash**: Execute commands
- **Read**: Read files
- **Write**: Create files
- **Edit**: Modify files
- **Search**: Find files/content (Glob, Grep)

Optional:
- **Web**: Fetch URLs
- **Task**: Spawn sub-agents

### Exposing Level 2 Capabilities

In agent instructions:
```
Available shell utilities: git, npm, docker, jq, ripgrep, fd
Use --help to learn about any utility.
```

Agent discovers usage on demand via `--help` or documentation.

### Level 3: Code Execution

Agent writes and executes code for:
- Complex data transformations
- Multi-step operations
- Operations without existing CLI
- Custom logic

## Anti-Patterns

| Anti-Pattern | Problem |
|:-------------|:--------|
| Tool for every action | Context bloat |
| Passing all output to context | Token waste |
| Hiding shell access | Limits flexibility |
| No code execution | Can't handle novel tasks |
